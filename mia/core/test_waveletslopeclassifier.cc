/* -*- mia-c++  -*-
 *
 * Copyright (c) Leipzig, Madrid 1999-2011 Gert Wollny
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 *
 */

#include <mia/internal/autotest.hh>

#include <stdexcept>
#include <cmath>

#include <mia/core/waveletslopeclassifier.hh>


using namespace std;
using namespace mia;

struct SlopeClassifierFixture {
	typedef struct {
		int periodic_idx;
		int RV_idx;
		int LV_idx;
		int baseline_idx;
		int perfusion_idx;
		int RV_peak;
		int LV_peak;
	} Result;
	void run(size_t length, size_t components, const float *data, const Result& r, bool mean_stripped);
	void check_equal(int a, int b, const char *descr); 
};

void SlopeClassifierFixture::check_equal(int value, int expect, const char *descr)
{
	if (expect != -2) 
		BOOST_CHECK_MESSAGE( value == expect, descr << ": got '" << value << "' expect '" << expect ); 
}

void SlopeClassifierFixture::run(size_t length, size_t components, const float *data, const Result& result, bool mean_stripped)
{
	CWaveletSlopeClassifier::Columns columns( components );

	for (size_t c = 0; c < components; ++c)
		columns[c].resize(length);

	const float *i = data;
	for (size_t r = 0; r < length; ++r)
		for (size_t c = 0; c < components; ++c, ++i)
			columns[c][r]  = *i;

	CWaveletSlopeClassifier c(columns, mean_stripped);
	check_equal(c.get_movement_idx(), result.periodic_idx, "periodic index"); 
	check_equal(c.get_RV_idx(), result.RV_idx, "RV index");
	
	check_equal(c.get_LV_idx(), result.LV_idx, "LV index");
	check_equal(c.get_perfusion_idx(), result.perfusion_idx, "perfusion index");
	check_equal(c.get_baseline_idx(), result.baseline_idx, "baseline index");
// peak location values are now based on smoothed curves 
//	check_equal(c.get_RV_peak(), result.RV_peak, "RV peak");
//	check_equal(c.get_LV_peak(), result.LV_peak, "LV peak");
}


BOOST_FIXTURE_TEST_CASE( test_classifier_mean_removed_4_2 , SlopeClassifierFixture
 )
{
	const size_t rdlength2 = 58;
	const size_t rdcomponents = 4;
	const float init_real_data5[rdlength2 * rdcomponents] = {
		-1.21697,    -12.889,    -8.8137,   -11.2628,
		7.26992,   -10.1643,   -7.71096,   -10.2105,
		3.36918,   -9.61763,    -7.5347,   -10.2059,
		-5.31023,   -10.8776,   -8.19432,   -10.7311,
		-3.61536,    -11.757,   -8.53927,    -10.786,
		7.43997,   -9.72578,   -7.70598,   -9.37773,
		3.96546,   -8.38908,   -7.17976,    -3.5115,
		-6.22638,   -9.78003,   -8.38516,    4.31378,
		-2.22855,   -11.1856,   -8.76427,    9.20779,
		8.28368,   -9.18611,   -8.94622,      13.12,
		1.34157,   -9.57345,   -7.77406,    15.3541,
		-5.89887,   -10.5877,   -7.39647,    13.6015,
		3.33047,   -10.4561,   -5.99676,    13.6439,
		11.51,   -8.87868,    -2.7022,    13.4846,
		-0.201523,    -9.3964,    4.60773,    12.5756,
		-6.46308,   -9.74944,    8.06126,    8.36199,
		2.09767,   -9.91261,    11.2294,    1.78679,
		9.98559,   -7.19383,    11.3783,    2.69818,
		-2.20947,   -6.43649,    11.8703,    2.25018,
		-6.46433,   -6.83957,    11.0092,  -0.542518,
		5.37192,   -5.87149,    12.3547,   -5.41251,
		3.82535,   -3.10461,     12.523,   -4.56304,
		-4.9578,   -1.60572,    10.4858,   -3.90724,
		-6.78449,   -1.70081,    8.48264,   -6.42681,
		6.01595,   0.314861,    8.62154,   -8.89845,
		6.47053,    3.85449,    7.31228,   -7.60484,
		-4.00454,    5.13422,    5.03714,   -5.66759,
		-7.35794,    4.92735,    2.79475,   -6.39917,
		0.160344,    4.97459,      2.087,   -7.57198,
		8.01644,    7.57877,     1.4296,   -5.21079,
		1.70258,    8.99215,   0.095665,   -2.86466,
		-5.86428,     8.2516,   -1.42558,   -2.07345,
		-7.57355,    7.06447,   -2.49541,  -0.815717,
		1.07946,     6.2852,   -3.01762,  -0.461196,
		10.2077,    7.14585,   -3.01935,    1.50698,
		2.50873,    9.08613,   -2.76672,    2.46428,
		-4.11772,    7.88459,   -2.81467,    2.72878,
		-7.30043,    6.71874,    -2.8543,    2.09026,
		-7.81432,    5.34063,   -2.81373,     2.2376,
		1.21732,     4.6602,   -2.02043,    1.28263,
		10.6291,    5.97178,    -0.9351,    1.94118,
		4.20717,    7.56745,   0.448437,    1.96171,
		-5.38515,    7.36575,   0.340722,    2.19751,
		-8.16073,    6.01278,  -0.015374,    1.08096,
		-0.268398,    4.54413,   0.434688,  -0.314944,
		10.1471,    5.79406,   0.677009,  -0.407828,
		2.88709,    7.32053,    1.45917,   0.511453,
		-6.25489,    6.58108,   0.717902,   0.687246,
		-7.81785,    5.45234,   0.138807,   0.325375,
		-5.39009,    4.31263,  -0.144036,  -0.700289,
		7.36143,    4.95953,   0.127016,   -1.10937,
		-0.0970818,    6.92727,   0.371997,   0.473863,
		-6.81938,    5.74919,  -0.475212,    1.05183,
		-8.47326,    4.63227,   -1.00542,  0.0984377,
		2.4529,    4.64438,  -0.785798,  0.0570382,
		9.60226,    6.35436,   -0.32421,   0.355114,
		-0.548125,    7.12886,  -0.522247,     1.8589,
		-7.63212,    5.34681,     -1.017,     1.7284
	};

	Result r;

	r.periodic_idx = 0;
	r.RV_idx = 3;
	r.LV_idx = 2;
	r.baseline_idx = -1;
	r.perfusion_idx = 1;

	r.RV_peak = 10;
	r.LV_peak = 21;

	run( rdlength2, rdcomponents, init_real_data5,  r, true);
}

BOOST_FIXTURE_TEST_CASE( test_classifier_7 , SlopeClassifierFixture )
{
	const size_t rdlength2 = 58;
	const size_t rdcomponents = 7;
	const float init_real_data5[rdlength2 * rdcomponents] = {
		-40.1047,   -16.9555,    -31.241,   -5.37162,   -37.6032,   -60.2176,   -35.8488,
		-40.2106,    -17.158,   -24.0179,    3.93582,   -31.7327,   -56.6077,   -40.0227,
		-39.706,   -16.7819,   -21.1349,     11.665,   -22.8374,   -55.1337,   -38.4269,
		-39.6016,   -16.9136,   -10.5167,    17.0759,   -15.2057,   -53.1984,   -28.7697,
		-39.063,   -16.0588,   -6.10676,    22.6064,    -3.6312,   -48.5633,   -15.1243,
		-39.3581,   -16.2762,   -7.06032,    24.1171,   -10.0958,    -49.588,   -17.7728,
		-38.8668,   -14.7053,   -46.5116,   -9.05628,   -55.0097,   -56.1233,   -29.6628,
		-40.3746,    -13.286,   -49.3572,   -24.1834,   -77.2354,   -59.6212,   -5.29381,
		-39.5176,   -14.9442,   -31.1151,    3.04364,    -38.783,   -58.3483,   -37.2792,
		-39.455,   -15.2395,   -5.50793,    21.5392,   -10.3132,   -53.7003,   -19.8789,
		-39.0905,   -14.0979,    9.05797,    17.4227,     13.864,    -42.044,    2.91938,
		-38.5726,   -13.5838,    24.1528,    1.71686,    24.5481,   -22.5903,    15.2367,
		-39.1421,   -14.4559,    28.8951,   -12.4527,    36.8647,    5.96355,    25.7209,
		-39.2029,   -15.4581,    32.3101,   -20.1741,    35.2295,    35.2465,    37.7428,
		-37.7105,   -15.2571,    32.9314,   -26.3422,    39.5647,    53.2982,    46.4405,
		-37.2369,   -16.0488,    28.8949,    -20.964,    33.2994,    62.2649,    50.1281,
		-38.3385,   -16.6371,    -9.9017,    23.3433,    -3.0373,    79.7468,     20.306,
		-35.5468,    -13.836,    -37.974,    3.68114,   -47.9387,    71.1057,   -50.7787,
		-28.6871,   -13.9207,   -41.4923,   -3.33156,   -47.7866,    57.8821,   -50.9853,
		-17.0224,   -16.4429,   -23.6838,    15.7667,   -32.3312,     43.044,   -42.4479,
		0.453652,   -16.6787,  -0.742737,    23.5956,    2.39767,    38.6267,    5.54717,
		17.8875,    -15.854,    21.5136,   -2.37443,    22.5439,    34.8509,    29.8368,
		34.6997,   -13.6318,    28.8985,   -17.3165,    36.3013,    32.4091,    31.8662,
		46.4006,    -11.754,    36.6534,   -24.8767,    37.9528,    25.1835,    27.6265,
		63.5513,    -9.1117,    11.4701,    6.47439,    21.6016,     23.102,    25.2581,
		70.7059,    -4.7131,   -25.0143,    25.1014,   -25.6462,    21.1808,   -13.2238,
		72.5551,   0.336157,   -50.7238,   -6.15387,   -60.6959,    8.96428,   -28.3438,
		65.8879,  -0.474331,   -36.1594,   0.823315,   -49.0889,   0.980592,   -34.5743,
		59.3859,    0.51508,   -2.96713,    24.8086,   -3.16753,   0.372514,     -1.803,
		52.3287,    2.47608,    25.8445,   0.802217,    23.5984,    4.97028,    20.3664,
		48.442,     4.7449,    28.0711,   -8.04611,    32.4982,    6.07814,    22.1791,
		42.157,    6.08515,    30.7636,    -8.3365,     29.568,     7.3208,    20.6963,
		38.0369,    8.27015,    38.2356,   -22.8385,    43.7139,    9.04308,     16.507,
		35.7178,    9.80106,    2.69103,    19.4516,    5.58973,    4.49146,    14.4299,
		32.1969,    11.7232,   -41.8881, -0.0484388,   -48.3417,   -1.74848,   -18.9144,
		21.4051,    13.4256,   -49.3679,    -31.708,   -88.3036,   -14.8064,    26.7785,
		18.0535,    12.6171,   -46.0581,   -20.3626,   -70.0092,   -19.3539,    3.00826,
		12.8971,    11.0537,   -17.3521,    18.1317,   -25.2302,   -13.6394,   -23.7161,
		12.1904,    13.4542,    12.1459,    16.7878,    16.0224,   -5.60132,    10.6164,
		9.47646,    13.1803,    33.3434,    -9.4209,    34.3551,   0.684297,    12.7443,
		7.46745,    14.0032,    38.8389,   -23.1083,    47.2274,    5.96492,    10.6184,
		4.16157,    14.2301,      43.17,   -28.9647,    46.9153,    7.51435,    8.43546,
		3.80424,    15.0953,    1.75047,    16.7508,    12.4179,    5.53774,    14.4093,
		1.15201,    14.0314,   -38.5151,    9.13972,   -41.9105,    2.82193,   -20.4217,
		-1.00213,    14.6358,   -46.2783,   -6.15891,   -51.7479,   -2.88448,   -20.7201,
		-3.47497,    13.1989,   -14.6609,    21.6352,   -16.7795,    -5.7776,   -18.7366,
		-1.93725,    16.0385,    12.5979,    14.1791,    22.6802,    0.96117,    13.1006,
		-3.02747,    15.0351,     28.907,   -4.28057,    34.8117,    4.71671,    14.3342,
		-2.36169,    15.6747,    30.7762,   -11.1889,    43.6844,    6.45374,    13.5113,
		-2.14671,     15.483,    33.4849,   -14.3573,    42.9311,    6.29532,    11.6864,
		-0.589087,    15.9458,    33.4673,   -16.6613,    47.3335,    6.64797,    11.1541,
		-1.77128,    15.2718,    35.2978,   -17.3162,    44.6695,    5.26655,    10.2135,
		-0.895071,    16.0546,   -5.75294,    18.2927,    6.24082,    3.73719,    8.01124,
		-1.18768,    14.8755,   -34.5721,    16.7591,   -35.6699,  -0.584476,   -11.9724,
		-1.80491,    15.1438,   -12.6631,    27.7462,   -6.94231,   -5.29563,   -6.68034,
		-0.63329,    15.9106,    19.1375,    4.41218,    28.2593,   -2.07846,    12.4051,
		-1.28552,    16.0875,    28.7921,   -12.8408,    43.1762,    2.12076,    10.5018,
		-2.08908,    15.8768,    36.2425,   -22.5702,    47.2133,    2.65797,    7.06177
	};

	Result r;

	r.periodic_idx = 4;
	r.RV_idx = 5;
	r.LV_idx = 0;
	// -2 == not important 
	r.perfusion_idx = -2;
	r.baseline_idx = -2; 


	r.RV_peak = 16;
	r.LV_peak = 26;

	run( rdlength2, rdcomponents, init_real_data5,  r, false);
}


BOOST_FIXTURE_TEST_CASE( test_classifier_4_anotherone , SlopeClassifierFixture )
{
	const size_t rdlength2 = 58;
	const size_t rdcomponents = 4;
	const float init_real_data5[rdlength2 * rdcomponents] = {
		-40.5885,   -42.0489,   -45.5256,   -1.06894, 
		-45.7077,    -53.409,   -40.5529,    1.06517, 
		-43.9552,    25.6663,   -41.0811,    2.05432, 
		-36.844,    5.05299,   -50.4248,    1.94573, 
		-39.9942,   -26.0527,   -46.9356,    2.28095, 
		-45.6154,   -49.3138,   -41.4347,    2.48059, 
		-47.2126,    -52.324,   -35.3429,    1.75445, 
		-40.0522,    40.6544,   -27.2421,    3.12005, 
		-29.7715,    35.8575,    -25.193,   0.977491, 
		-31.841,    -7.7891,   -3.07592,    1.19795, 
		-32.9921,    -31.021,    35.4505,    1.52449, 
		-37.4308,   -59.7679,    41.8424,    1.47142, 
		-36.9135,   -40.6995,    59.4962,    1.06211, 
		-20.994,    106.464,    31.7577,    5.98843, 
		-14.6221,    62.0819,    20.9851,    0.23603, 
		-10.7321, -0.0692243,    27.4757,   0.413571, 
		-17.7299,    -62.248,    34.1193,  -0.311548, 
		-6.68392,    75.3428,    31.0272,    1.18152, 
		13.2246,    92.2324,     21.553,    2.25978, 
		20.0892,    22.3414,    15.2671,   -1.34974, 
		7.86028,   -45.8267,    16.3647,   0.516328, 
		17.6371,   -61.1057,    28.2191,   0.207029, 
		28.6596,   -65.0605,     19.038,   -1.37892, 
		5.11108,   -68.7915,     17.638,    1.79901, 
		13.4148,   -75.7552,    12.8194,  -0.115909, 
		14.3393,    78.6177,    2.17008,    1.95503, 
		25.2623,    97.5555,   -5.16663,    3.44103, 
		31.7565,    31.7876,   -11.3776,  -0.988721, 
		14.8972,    -43.411,   -2.89347,  -0.513903, 
		7.4624,   -64.9449,    4.15604,  -0.985499, 
		7.82721,    13.4014,    2.53395,   -2.50635, 
		21.7543,    81.3186,   -3.75994,    1.38046, 
		25.6319,    10.6536,   -12.1314,   -2.83351, 
		18.1948,   -28.0865,   -5.26292,   -1.96467, 
		4.11488,   -58.1767,   0.623238,  -0.502474, 
		5.59611,    32.4971,    1.39253,   -0.96725, 
		18.493,    99.1702,  0.0843583,    3.00145, 
		22.6629,    41.9831,   -8.01348,  -0.984234, 
		22.546,   -16.2061,   -2.86221,   -2.31817, 
		5.52405,   -45.3296,    1.26168,   -1.13303, 
		10.0739,   -60.5249,    7.83677,   -2.10769, 
		6.34081,   -3.28841,    7.01992,   -1.95952, 
		9.07522,    68.8657,  -0.637501,  -0.527897, 
		22.5867,    87.4689,   -5.53472,    1.61981, 
		12.4519,   -21.1978,   -4.01191,   -1.42338, 
		1.86497,    -61.235,    4.57168,   -1.44206, 
		-0.0375902,   -31.0413,    7.91329,    -2.8754, 
		14.55,    84.5825,    3.55639,    1.11224, 
		25.2812,    80.1884,   -6.38595,  -0.818489, 
		22.9835,    15.3067,     -6.824,   -2.93083, 
		5.21044,   -48.3389,   0.447882,   -1.86792, 
		10.0186,   -64.4603,    5.60138,   -1.97099, 
		7.02159,   -3.22657,    2.33767,   -1.85069, 
		17.6422,    100.899,   -3.03946,    2.76228, 
		27.9474,    40.2603,   -14.0553,   -2.73036, 
		23.8631,   -11.4303,   -9.09685,   -1.59569, 
		8.58541,   -61.0184,   -5.24212,   -2.93687, 
		2.16168,   -67.0509,   -1.45668,   -1.84713
	}; 

	Result r;
	
	r.periodic_idx = 1;
	r.RV_idx = 2;
	r.LV_idx = 0;
	r.baseline_idx = 3;
	r.perfusion_idx = -1;

	r.RV_peak = 12;
	r.LV_peak = 27;

	run( rdlength2, rdcomponents, init_real_data5,  r, false);

}

BOOST_FIXTURE_TEST_CASE( test_classifier_5_B0 , SlopeClassifierFixture )
{
	const size_t rdlength2 = 58;
	const size_t rdcomponents = 5;
	const float init_real_data5[rdlength2 * rdcomponents] = {
		  -21.5101,  -70.9349,  -54.8832,  -8.02363,  -107.674,
		  62.1742,  -61.8815,  -47.4486,   4.05271,  -82.3734,
		  21.1974,  -59.8629,  -45.0058,   4.71944,  -73.2937,
		  -63.8195,  -64.4069,  -48.9134, -0.517728,  -82.9371,
		  -44.6033,  -66.3626,  -52.0342,  -10.5712,  -93.3152,
		  63.7975,  -55.3954,   -46.507, -0.653942,  -75.4164,
		  28.0447,  -16.1006,  -40.4158,   10.7913,  -59.1176,
		  -69.8763,   31.9211,  -45.9987,    -2.826,  -69.2282,
		  -26.7364,   60.8714,  -48.6856,  -12.1556,  -85.1516,
		  77.0263,   90.6266,   -49.494,   2.30612,  -72.2751,
		  6.60981,   105.819,   -39.695,   2.75522,  -67.0276,
		  -64.8293,   96.3348,  -37.5808,  -7.24514,   -74.002,
		  30.5064,   89.9653,  -31.3594,  -18.1576,  -78.7652,
		  108.75,   87.6518,  -11.9986,   12.7854,  -67.3555,
		  -7.17098,   82.2409,   34.1087,    7.7757,  -60.5163,
		  -66.6993,    52.693,   53.2669,  -1.92582,  -63.9904,
		  20.235,   7.44192,   68.8185,  -7.64787,  -71.8108,
		  95.2104,    15.592,   70.2948,   14.8668,  -50.2588,
		  -25.6608,   14.8632,   75.2925,   8.50921,  -36.3162,
		  -64.3794,  -5.86425,   67.8701,   -8.7853,  -44.2359,
		  52.9093,   -38.592,   72.9375,  -6.64724,  -43.5992,
		  36.184,  -30.9802,   75.2212,   3.90409,  -18.6681,
		  -49.2223,  -26.9414,   63.1073,   -1.3883,  -6.23317,
		  -64.0443,  -46.3739,   48.2332,  -17.0704,  -14.3219,
		  60.7041,  -62.3946,   46.9352,  -1.94719,   -5.1516,
		  63.782,  -50.9867,    40.588,   13.0022,    25.205,
		  -38.3441,   -37.823,   28.2475,   7.91706,   39.2549,
		  -70.9549,  -43.1368,   14.1473,   3.22068,   36.2974,
		  7.2602,  -54.1956,   6.75973,  -8.44868,   27.9151,
		  81.9071,  -35.6415,   4.40277,   7.70883,   50.4127,
		  19.2254,  -18.7763,  -1.67137,   10.5708,   66.0645,
		  -55.1381,  -13.5242,  -9.95895,   6.88407,   62.9892,
		  -71.2352,  -6.11588,  -16.3596,  0.805754,   53.3075,
		  17.062,  -7.76605,   -22.362,  -8.62473,   37.7436,
		  105.107,   6.48572,  -21.9431,   6.54207,   44.2286,
		  26.8782,   16.6228,  -17.1102,   12.4349,   67.9287,
		  -38.5988,   18.7706,  -16.3778,   11.5548,   62.0762,
		  -69.2257,   13.9064,  -16.8515,   3.47106,   53.1891,
		  -73.425,   13.3029,  -17.3533,  -3.04657,   40.4217,
		  19.0144,   3.20832,  -15.6279,  -14.6578,   26.3543,
		  109.544,   9.69094,  -8.43266,   6.15825,   37.8081,
		  43.812,   13.2359,    2.6147,   15.8953,   57.2712,
		  -50.1025,   15.9711,   3.65279,    8.8972,   62.3557,
		  -77.2073,   7.77249,  0.914186, -0.131839,   50.9678,
		  4.26769,  -5.55192,   0.16415,  -9.82492,   29.7144,
		  105.686,   -5.5131,  0.836226,  0.499044,   36.7304,
		  31.171,   4.44616,   8.93191,   12.0494,   57.4705,
		  -58.2973,   5.62527,   5.36304,   2.83262,   55.1484,
		  -74.1288,   2.69363,   1.47169,  -1.29271,   45.9818,
		  -45.5706,  -8.30323,  -3.35438,  -19.7296,   28.5993,
		  78.246,  -10.3823,  -2.57134,  -8.38768,   30.3896,
		  2.64925,   3.50841,   2.11872,  0.513459,   53.6509,
		  -64.2622,   7.88266,  -1.88002, -0.417225,    48.533,
		  -78.8516, -0.302667,  -6.44013,  -13.7938,   36.8173,
		  30.5377,  -2.53047,  -7.10827,  -12.5386,   30.1156,
		  99.094,   1.31508,  -3.91258,   4.09474,   43.7485,
		  -2.82663,   14.2099,  -1.89937,   6.12335,   58.8309,
		  -71.8716,    11.971,  -5.06392,  -7.18392,   45.5126
	}; 

	Result r;
	
	r.periodic_idx = 0;
	r.RV_idx = 1;
	r.LV_idx = 2;
	// these two are not yet sure
	r.baseline_idx = 3;
	r.perfusion_idx = 4;

	r.RV_peak = 10;
	r.LV_peak = 18;

	run( rdlength2, rdcomponents, init_real_data5,  r, false);

}


BOOST_FIXTURE_TEST_CASE( test_classifier_6_C2 , SlopeClassifierFixture )
{
	const size_t rdlength2 = 58;
	const size_t rdcomponents = 6;
	const float init_real_data5[rdlength2 * rdcomponents] = {
		-8.0101,   -6.6292,   -1.0932,   -1.6704,   -5.6265,   -0.6992, 
		-8.040,   -6.4465,   -1.6401,  -0.77928,   -5.7204,   -1.1880, 
		-8.2539,   -6.5067,   -1.7867,    2.3910,   -5.5661,   -1.4240, 
		-8.0557,    -6.354,   -1.6349,   0.97241,   -5.8858,   -1.4973, 
		-8.3040,   -7.5478,   -1.2558,   -1.4791,   -5.9235,  -0.30735, 
		-8.2773,   -7.5983,   -1.3065,   -1.8441,   -5.7190,   -0.5452, 
		-8.4375,   -8.1789,   -1.1530,   -2.1642,   -5.6946,   0.27344, 
		-8.6953,   -4.3771,   -1.6733,  -0.39734,   -5.4214, -0.058206, 
		-8.7127,    2.0076,   -2.1174,    3.5053,   -5.2961,   -1.0314, 
		-8.9817,    5.3303,   -2.5154,  -0.28142,   -5.6244,   -1.4685, 
		-9.0203,     4.908,   -2.4876,    -1.731,   -5.4462,   -1.1935, 
		-8.7601,     7.085,   -2.3534,    4.1079,   -5.3636,   -2.1993, 
		-8.578,    6.7144,   -2.1547,    2.5391,   -5.3934,   -1.5212, 
		-7.3813,    5.2189,    -1.930,   -1.3980,   -5.5579,   -1.2851, 
		-4.533,    7.0932,   -0.9575,    6.8164,   -5.4966,   -1.5768, 
		-0.24197,    5.3156,   -1.1462,   -1.0400,   -5.8393,  -0.85097, 
		2.1599,    5.1330,   -1.0303,   -2.1476,   -5.5513,  -0.58508, 
		3.7900,     5.791,  -0.71236,    7.2983,   -5.2761,   -1.8629, 
		4.8967,    4.7546,  -0.81506,     5.928,   -4.9074,   -1.1040, 
		5.9867,    3.6350,   -1.5362,     1.297,    -4.664,   -1.5128, 
		5.9795,    2.8737,   -1.9170,   -1.1385,   -3.7905,  -0.83006, 
		6.5737,    2.9859,    -1.928,   0.69419,   -3.6330,   -1.3395, 
		7.4382,    1.4968,   -1.8823,    4.3124,   -2.3191,  -0.76904, 
		7.6952,   0.61872,   -2.7890,  -0.96450,   -1.0520,  -0.59752, 
		6.6975,  0.059176,   -2.8385,   -1.6344,  -0.43895,  -0.38372, 
		7.2778,  -0.64810,   -2.9383,  -0.16634,   0.48404,  -0.62560, 
		6.9095,   -1.6369,   -2.4962,    2.2712,    1.2636, -0.023400, 
		7.1705,   -1.6682,     -2.86,  -0.40294,    2.0103,  -0.43516, 
		6.1047,     -2.30,   -2.7221,   -1.4972,    2.7044,  0.087195, 
		5.9002,   -1.8728,   -2.8025,   -1.6648,    3.1951,  -0.23712, 
		5.1572,   -2.5403,   -2.4650,   -1.8835,    3.7428,   0.78698, 
		4.9439,   -1.8317,   -2.4125,   -1.8068,    3.9336,   0.30007, 
		4.4442,   -1.7404,   -2.1956,   -2.0497,    4.1353,   0.50845, 
		4.2006,   -1.1668,   -1.9305,  -0.58836,    4.2371,   0.22182, 
		3.2853,   0.61490,  -0.89186,    5.8707,    3.3223,  0.074369, 
		2.8141,   0.33152,  -0.86839,    3.6462,    3.8438,   -0.1525, 
		2.1143,  -0.69786,  -0.55793,   0.47959,    4.4961,   0.75559, 
		1.4756,  -0.39758,   -0.5773,   -1.2553,    4.8508,   0.38611, 
		0.84742,  -0.82545,  -0.17122,   -1.8887,    5.1022,    1.2629, 
		0.44867,  0.058669, -0.076966,   -1.9529,    5.0646,   0.74560, 
		0.0484,   0.85795,   0.59066,   -1.7323,    5.0179,    1.2818, 
		-0.11689,    1.5419,    1.3608,    2.4867,    4.2181,    0.5254, 
		-0.58463,  -0.19010,     2.177,    -2.092,    4.7612,    1.6920, 
		-0.48445,   0.38419,    2.3046,   -2.1089,    4.4942,    1.0318, 
		-0.52464,  0.065400,    2.7419,   -2.3992,    4.4677,      1.43, 
		-0.3666,    0.4942,    2.8007,   -2.4002,    4.4656,   0.97326, 
		-0.30475, -0.035246,     3.225,   -2.3533,     4.447,    1.8105, 
		0.54532,    2.1619,    3.1564,    4.5224,    3.0514,   0.46030, 
		0.90629,   0.40378,    4.1826,   -0.6755,    3.5306,    1.3306, 
		0.69150,  0.022096,    4.1978,   -1.9441,     3.737,   0.99065, 
		0.61417,  -0.92978,    4.7001,    -2.656,    3.7238,    1.8162, 
		0.78069,  -0.64974,     4.737,   -2.4583,    3.5742,   0.98676, 
		0.8209,   -1.3051,     5.018,   -2.8227,    3.5411,    1.7154, 
		1.1929,  -0.48763,    5.1149,    -1.583,    3.4584,    1.0313, 
		1.1464,   -0.3575,    5.2153,      2.27,    3.0219,    1.2645, 
		1.477,  -0.38193,    5.4776,    1.4851,    2.8658,    1.0098, 
		1.177,   -1.2718,     5.875,   -1.6330,    3.1645,    1.4878, 
		0.95245,   -1.3796,    5.7530,   -2.2149,    3.2797,    1.0581
	}; 

	Result r;
	
	r.periodic_idx = 3;
	r.RV_idx = 1;
	r.LV_idx = 0;
	// these two are not yet sure
	r.baseline_idx =  5;
	r.perfusion_idx = 4;

	r.RV_peak = 14;
	r.LV_peak = 23;

	run( rdlength2, rdcomponents, init_real_data5,  r, false);

}

/* this case is wired, because it has three curves that go like the RV resp. LV slope
   and the curve with the second peak is not the curve corresponding to LV
*/
BOOST_FIXTURE_TEST_CASE( test_classifier_5_F0 , SlopeClassifierFixture )
{
	const size_t rdlength2 = 58;
	const size_t rdcomponents = 5;
	const float init_real_data5[rdlength2 * rdcomponents] = {
		-1.94093,   -2.22639,  -0.454596,  -0.494999,  -0.875512, 
		-2.09092,   -1.96308,   0.274693,  0.0420033,  -0.884541, 
		-2.39933,   -1.26464,    2.18684,    3.45699,   -1.17218, 
		-2.49704,   -1.23793,    3.15615,    3.87301,   -1.22643, 
		-2.33235,   -2.27218,    0.98297,    1.73169,  -0.565737, 
		-2.12292,   -2.52527,  -0.312057,  -0.448708,  -0.705599, 
		-2.04212,   -2.49513,  -0.900663,   -1.12107,  -0.835032, 
		-1.8393,   -2.28073,  -0.673069,   -1.30261,  -0.893544, 
		-1.7013,   -2.18536,  -0.822437,   -1.32805,  -0.901629, 
		-1.11892,   -2.05607,  -0.704989,   -1.39669,  -0.983482, 
		-0.213324,   -1.85668,  -0.839027,   -1.41562,   -1.05305, 
		0.930339,   -1.65519,  -0.153921,  -0.930953,   -1.03596, 
		2.25885,   -1.45491,    1.36464,    2.14384,  -0.931364, 
		2.27491,   -1.08486,    3.16624,    4.11149,    -1.3313, 
		1.92447,   -1.44353,    2.63393,    3.85504,  -0.912345, 
		1.904,   -2.04967,   0.876701,    1.00615,  -0.583686, 
		2.15282,   -1.67093,  -0.496686,   -1.04203,    -1.0735, 
		2.21635,   -1.14727,  -0.481134,   -1.60091,   -1.28448, 
		2.23147,  -0.848128,  -0.854763,   -1.80684,      -1.44, 
		2.0163,  -0.408091,  -0.597779,   -1.86561,   -1.49489, 
		1.85101, 0.000625353,   -0.80677,   -1.91716,   -1.49872, 
		1.55141,   0.400215,  -0.706338,   -1.98691,   -1.49578, 
		1.28714,    0.87095,  -0.917631,   -1.91255,   -1.49962, 
		1.30471,    1.27804,  -0.444114,   -1.47287,    -1.2028, 
		1.30552,    1.58867,    1.11224,    1.78384,  -0.594001, 
		0.532234,    2.25814,    3.07555,    4.27038,  -0.593337, 
		0.176223,     1.3933,    1.46477,    2.63887,   0.120363, 
		0.0962069,    1.27045, 0.000553948,  -0.207517,  -0.208462, 
		0.0716291,    1.65977,   -0.68619,   -1.07736,  -0.332839, 
		0.0441768,    1.77499,   -0.60984,    -1.4853,  -0.341352, 
		0.111908,     1.8818,   -1.01017,   -1.60148,   -0.24143, 
		0.00634145,    1.87987,  -0.768055,   -1.63295,  -0.131913, 
		-0.0262725,    1.85573,   -1.06344,   -1.64376,  0.0691653, 
		-0.166551,    1.70549,  -0.898538,    -1.7405,   0.150887, 
		-0.155525,    1.65284,   -1.04854,   -1.67441,   0.223156, 
		-0.147284,    1.51336,  -0.922098,   -1.71695,   0.361011, 
		-0.182721,    1.29605,   -1.20181,   -1.68583,   0.494953, 
		-0.170892,    1.29562,  -0.580724,   -1.02746,   0.759244, 
		-0.283859,    1.51448,    1.31743,    2.54945,   0.997865, 
		-0.518206,    1.12166,    1.80346,    2.98934,    1.18769, 
		-0.490226,   0.303154,  -0.277554,   0.211234,    1.50803, 
		-0.370318,   0.511664,    -0.8235,   -1.12226,    1.16869, 
		-0.133937,   0.530374,   -1.29119,    -1.4049,    1.08555, 
		-0.0771668,   0.620317,   -1.02762,   -1.50872,    1.00444, 
		0.0103271,   0.630441,   -1.32661,   -1.55761,    1.01029, 
		0.0045716,   0.603544,  -0.896228,   -1.24247,    1.14284, 
		-0.114743,   0.890228,    1.19853,    2.74495,    1.29275, 
		-0.513404,   0.955831,    2.73933,    4.18979,   0.760301, 
		-0.574799,   0.200256,    1.52937,    3.27784,    1.61438, 
		-0.478663,  -0.359473,   -0.16795,   0.372018,    1.72966, 
		-0.277515, -0.0876695,   -1.00261,  -0.671844,    1.48313, 
		-0.206162,  0.0544186,  -0.699549,   -0.71786,    1.42518, 
		0.0406744,   0.145341,   -1.11395,   -1.01474,    1.35172, 
		-0.0215364,   0.255212,   -0.93445,   -1.12482,    1.28284, 
		-0.00850971,   0.200924,    -1.1022,  -0.862077,     1.3917, 
		-0.257579,   0.682917,    1.37962,    2.82516,     1.3335, 
		-0.442878, -0.0842596,    0.48812,    1.68203,    1.87391, 
		-0.386374,   -0.13925,   -1.13249,  -0.990747,    1.50127
	}; 
	
	Result r;
	
	r.periodic_idx = 3;
	r.RV_idx = 0;
	r.LV_idx = 1;
	// these two are not yet sure
	r.baseline_idx = -2;
	r.perfusion_idx = -2;

	r.RV_peak = 13;
	r.LV_peak = 25;

	run( rdlength2, rdcomponents, init_real_data5,  r, true);

}


BOOST_FIXTURE_TEST_CASE( test_classifier_5_O1a , SlopeClassifierFixture )
{
	const size_t rdlength2 = 58;
	const size_t rdcomponents = 5;
	const float init_real_data5[rdlength2 * rdcomponents] = {
		-0.194644,  -2.27097,  -3.36575,   -2.5364,  -5.34558,
		0.765331,   -3.8211,  -3.73159,   -1.9391,   2.65789,
		-0.892364,  -3.58818,  -4.24303,   1.22069,   5.74515,
		-1.13437,    -4.627,  -4.34544,    1.4242,   1.64877,
		-0.365101,  -12.5294,  -3.35878,  -3.83679,  -5.50722,
		1.76301,  -12.3425,  -4.54628,  -5.93627,   4.39628,
		0.261274,  -7.04237,  -5.33096,  -1.93964,   4.98745,
		-1.88556,   -1.9671,  -6.11784,  -2.90995, -0.520417,
		-0.901675,  0.215163,  -7.62535,  -5.55443,   2.47797,
		1.33391,  0.927133,  -8.08026,  -4.14495,   4.43153,
		0.172277,   1.73026,  -8.28958,  -1.04375,   1.72171,
		2.72399,    1.9474,  -6.70993,  -3.95895,  -5.91067,
		0.549728,    1.5259,  -7.29375,  -6.14811,   3.52236,
		0.452623,   1.84944,   -6.6882,  -2.86127,   6.54145,
		-1.70723,   2.82367,  -5.80605,  -3.08049,     7.237,
		0.880562,   3.20682,  -4.63637,   -2.6166,    7.6504,
		2.08701,   4.45134,  -1.44584,  -4.01091,  -4.37968,
		4.04924,   3.69677,-0.0889484,  -9.95966, -0.413756,
		0.585227,   2.99372, -0.863572,  -4.15864,   8.00943,
		-1.20131,   3.27061,-0.0777571,  -2.53295,   8.29044,
		-0.711145,   4.17774,   1.73297,  -1.58116,  -4.50367,
		2.30682,   3.01388,   2.83435,  -5.12192,  -5.33368,
		0.669934,   2.71462,   3.84647,  -8.90214,   1.42903,
		0.929072,   1.62788,   3.00085,  -3.00467,   7.24816,
		-1.2227,   1.57794,   3.68044,  -2.16732,   6.30188,
		-2.20204,  0.693496,   3.45937,   1.11622,   8.23672,
		-1.18,   1.64482,   3.73222,   3.28705,  -2.63859,
		0.368327,  0.764952,   3.90995,  -2.69701,  -5.26728,
		-1.03298,  0.210432,   4.71717,  -8.19011,  0.735514,
		0.000465238, -0.626899,   3.46267, -0.773838,   6.96087,
		1.54549, 0.0666781,   3.24886,   3.01055,  -2.64503,
		-1.73513,  0.599961,   3.47547,  -3.48053,  0.690474,
		-1.81159, -0.819506,   3.01698,    2.0462,   6.36906,
		-0.0444954,  -2.13922,   2.60177,   5.90034,   6.89727,
		-3.05218,  -1.75002,   2.45012,   7.54744,   7.11101,
		-1.08303, -0.651417,   1.47778,   11.1662,  0.288925,
		0.543421,   1.52315,  0.899992,   5.66699,  -10.7938,
		-0.624826,  0.551983,   2.02829,  -1.50053,  -7.06782,
		-1.07646, -0.238251,   2.15248,  -1.93367,  0.998062,
		-2.37593, -0.715036,    1.2021,   4.64283,   5.50439,
		-1.97033,   1.05419,   0.88446,   6.85845,   -8.2401,
		0.511671,   1.59969,  0.668511,   2.01078,  -11.1567,
		0.739805, -0.205666,   2.19111,  -1.68312,  -5.19492,
		-2.63537, -0.775507,   1.84313,   1.26641,   4.54483,
		-1.25479, -0.456243,   1.39067,   6.78639,   3.37954,
		2.46874,   3.15283,  0.408595,   7.34536,   -11.579,
		2.95337,   2.04668,   1.53156,   0.30056,  -11.7758,
		1.50927,  0.995085,   2.70701,  -2.91524,  -6.88716,
		1.11713,  -1.01366,   3.37843,  -2.06459,   1.41302,
		0.38442,  -1.39239,   2.54671,   6.78968,   5.86022,
		-0.237717,   1.78274,   1.79331,   9.10484,  -7.48854,
		1.96697,  0.595994,   2.54992,   4.37264,  -8.25502,
		0.279202,  -1.28502,   3.41409,  0.174649,   2.20281,
		-1.13495, -0.966977,   2.23015,   8.88276,   5.04827,
		-0.120631,   1.94788,    1.2486,   7.73192,  -9.82988,
		1.3372,   1.35175,   1.66208,   2.66613,  -10.8625,
		-1.55511,  0.256317,   2.85736, -0.621103,  -4.08806,
		0.0887002,  -1.36443,   2.40927,   4.48657,   5.14687
	
	}; 
	
	Result r;
	
	r.periodic_idx = 4;
	r.RV_idx = 1;
	r.LV_idx = 2;
	// these two are not yet sure
	r.baseline_idx = -2;
	r.perfusion_idx = -2;

	r.RV_peak = 16;
	r.LV_peak = 28;

	run( rdlength2, rdcomponents, init_real_data5,  r, false);

}


BOOST_FIXTURE_TEST_CASE( test_classifier_5_O1b , SlopeClassifierFixture )
{
	const size_t rdlength2 = 58;
	const size_t rdcomponents = 5;
	const float init_real_data5[rdlength2 * rdcomponents] = {
		-2.6871,  -2.28011,  -3.38407,  -5.24146, -0.433329,
		-4.05581,  -1.95256,  -3.37925,   2.80988,  0.599094,
		-3.75048,   1.29595,  -3.75867,   5.98233, -0.714227,
		-4.93509,   1.55628,  -3.81322,   1.94058,  -1.11442,
		-12.7718,  -3.99865,  -2.50314,  -5.03172,  -1.66106,
		-12.423,  -6.34533,   -3.5695,    4.7923,  0.615769,
		-7.27844,  -1.99303,  -4.66206,   5.29481,-0.0396878,
		-2.33217,  -2.42312,   -6.2368, -0.364265,  -1.80293,
		-0.19083,  -4.98816,  -8.02633,   2.50387, -0.622646,
		0.293297,  -3.72944,  -8.24063,   4.41801,     1.824,
		0.930989, -0.460923,  -8.41273,    1.7632,  0.912264,
		0.922238,  -3.49721,  -6.98733,  -5.99577,   2.99864,
		1.08277,  -5.67124,  -7.74424,   3.45292,  0.896835,
		1.45573,  -2.48071,   -6.8974,   6.50839,   1.06229,
		2.73141,  -2.56815,  -6.29424,   7.18928,  -1.04998,
		3.01166,  -2.36753,  -4.93286,   7.52773,   1.50169,
		4.07038,  -3.77088,  -2.05523,  -4.63485,   2.24413,
		3.70047,  -10.0267,  -0.89129, -0.813087,   3.70847,
		3.30206,  -4.14359,  -1.31542,    7.8118,  0.817536,
		3.75384,   -2.4407, -0.576383,   8.13343, -0.871883,
		4.26715,  -1.36786,   1.08194,   -4.7007, -0.631475,
		3.09109,  -5.21787,   2.23881,  -5.62555,   1.91847,
		3.45826,  -9.06248,   2.93734,   1.08651, 0.0848312,
		2.25296,  -3.32165,   2.74437,   7.05657,  0.803839,
		2.38633,  -2.35891,   3.30662,   6.15915,  -1.34672,
		1.50998,  0.917034,   3.37006,   8.20787,  -2.13057,
		1.88326,   3.22905,    3.6599,  -2.67486,  -1.12737,
		1.04652,  -2.83304,    3.5541,  -5.40886,  -0.13392,
		1.16108,  -8.38057,   3.95342,  0.521333,  -1.87044,
		0.0466207,  -1.15753,   3.51229,   6.90706, -0.223467,
		0.0515692,   2.71641,   3.52409,  -2.67069,   1.44024,
		1.27814,  -3.54781,   2.99009,  0.580945,  -2.13111,
		-0.177071,   1.81217,   3.15626,   6.41683,  -1.83154,
		-1.81497,   5.47261,   3.30884,   7.03806, 0.0866037,
		-1.25122,   7.35534,   3.01564,   7.32697,   -2.7325,
		-0.847239,   11.0478,   2.29227,  0.515116,  -0.50884,
		0.904234,    5.8041,    1.0846,  -10.7599,  0.766765,
		0.602109,  -1.42075,   1.70485,  -7.12815, -0.957428,
		0.20139,  -2.01366,   1.93427,  0.956927,  -1.35333,
		-0.358474,   4.57577,   1.49353,    5.6365,  -2.09492,
		0.70094,   7.10685,   1.04098,  -8.12112,  -1.63661,
		1.09538,   2.19787,  0.563649,  -11.1879,  0.513716,
		-0.165751,  -1.78239,   2.05377,   -5.2607,  0.336546,
		-0.22604,   1.21235,    1.8453,   4.61336,  -2.64461,
		-0.348253,   6.66242,   1.87904,   3.51905, -0.877165,
		2.20159,   7.44715,   0.70876,  -11.6048,   2.95761,
		1.46878,  0.291052,   1.42647,  -11.9153,   2.78655,
		0.996918,  -3.01427,   2.39401,  -7.04231,   1.05948,
		-0.600393,  -2.42861,   3.38715,   1.33696,  0.655421,
		-1.19521,    6.3803,   3.27061,   5.98266,  0.623105,
		1.30704,   9.16821,   2.18418,  -7.40491,  0.243124,
		0.192516,   4.21483,   2.84935,  -8.26614,   1.93438,
		-0.856208, -0.169894,   3.56324,   2.19267,-0.0406716,
		-0.797151,   8.62799,   2.94761,   5.22797, -0.698049,
		1.36926,   7.88262,   1.50564,  -9.76843,  0.277812,
		0.869443,   2.70616,   1.68791,  -10.9043,   1.28337,
		0.554758, -0.601956,   2.58451,  -4.11995,  -1.85009,
		-1.08934,   4.13692,   2.92538,   5.23481,   0.17826
	}; 
	
	Result r;
	
	r.periodic_idx = 3;
	r.RV_idx = 0;
	r.LV_idx = 2;
	// these two are not yet sure
	r.baseline_idx = 4;
	r.perfusion_idx = -2;

	r.RV_peak = 20;
	r.LV_peak = 28;

	run( rdlength2, rdcomponents, init_real_data5,  r, false);
}

BOOST_FIXTURE_TEST_CASE( test_classifier_O1_6 , SlopeClassifierFixture )
{
	const size_t rdlength2 = 58;
	const size_t rdcomponents = 6;
	const float init_real_data5[rdlength2 * rdcomponents] = {
		-2.77055, -0.265872,  -5.20511,  -3.03599,  -2.36573,  -1.37281,
		-3.70677,  0.802571,   2.86372,  -2.80463,  -1.95339,  -2.51224,
		-3.77979, -0.925463,   5.92496,  -2.99664,   1.37772,  -2.25416,
		-3.04121,  -1.48487,    1.6407,  -4.22996,   2.37358,  -4.11419,
		-4.37504,  -1.05836,   -5.7074,  -4.97192,  -2.06339,  -12.6238,
		-5.32462,   1.36955,   4.39147,  -5.25371,  -4.73224,  -11.6956,
		-4.29338,-0.0281367,   5.05554,  -5.19541,  -1.03104,  -6.18687,
		-3.58669,  -1.99318, -0.303481,   -5.4649,  -2.51188, -0.749688,
		-4.52651, -0.663055,   2.95633,  -5.88969,  -5.94163,   2.41541,
		-4.61548,   1.61291,   4.93368,  -6.03006,  -4.60757,   3.27965,
		-4.16737,  0.281302,   2.13406,  -6.38532,  -1.15072,   3.80306,
		-3.46899,   2.86889,  -5.52987,  -5.45404,  -4.22922,   3.72366,
		-3.74604,  0.844147,   3.99733,  -5.69093,  -6.62785,   3.53537,
		-2.32414,  0.532771,   6.83017,  -5.68331,  -2.77011,    3.0281,
		-0.114875,  -1.84865,   7.32753,  -6.01068,  -2.36349,   2.82192,
		1.54025,  0.603296,    7.5741,  -5.75695,  -1.50922,   2.30902,
		5.18501,   1.44409,  -4.81972,  -5.00802,  -2.07493,   1.55884,
		6.17316,   3.54334, -0.858154,  -4.43865,  -8.20001,  0.342166,
		5.1087, 0.0764115,   7.59964,  -4.04693,  -2.41277,  0.170924,
		5.587,  -1.74285,   7.83363,  -3.26171, -0.752185,  0.266821,
		7.92806,  -1.63875,  -5.25932,  -3.21019,   1.01929, -0.246781,
		6.39269,   1.77972,  -5.86554,  -1.20087,  -3.57999, -0.379793,
		6.57641,  0.393975,  0.997287,0.00417351,  -7.87877, -0.525804,
		4.82726,  0.713778,   6.89581,  0.570761,  -2.19699, -0.748064,
		4.76788,  -1.41258,   5.95744,   1.46316,  -1.49788, -0.698603,
		3.53216,  -2.33747,   7.95574,   2.16139,   1.56583, -0.965186,
		4.39952,  -1.58839,  -3.07949,   1.64209,   4.26953,   -0.6179,
		2.70297,    0.3492,  -5.44509,   2.53954,  -2.70895, -0.421934,
		2.36568, -0.712006,  0.729666,   3.71293,  -8.94077, -0.529215,
		1.08449,  0.243643,   6.95007,   3.55099,  -1.36585, -0.854529,
		1.35004,   1.52945,   -2.7861,   2.95928,   2.90249, -0.478728,
		0.837587,  -1.36629,  0.788361,   3.73275,  -4.46735,  0.731903,
		-0.214726,  -1.49478,   6.45403,   4.09836,   1.15305,  -0.31338,
		-1.3669,  0.229541,    6.9832,   4.27715,   5.03921,  -1.22923,
		-1.41967,  -2.81159,   7.19677,   4.37016,   6.72529, -0.769299,
		-0.929233,  -1.13408,  0.233934,   2.90592,   10.9949,  -0.11774,
		-1.20463,  0.672729,  -10.6882,   2.26684,   4.98174,   2.50442,
		-1.012, -0.245582,  -6.85946,   3.09461,  -2.68055,     1.562,
		-1.08954, -0.604067,   1.23592,   3.45378,  -3.23482,  0.837527,
		-1.3107,  -2.13096,   5.63291,   2.83408,   3.89145,  0.242212,
		-0.241386,    -2.074,  -8.28958,   1.53782,   6.81473,   1.29618,
		-1.00407,  0.684163,  -11.0206,   1.66135,   1.29339,   2.48209,
		-0.57366,   1.02914,  -5.06741,   2.77975,  -2.57482,  0.405277,
		-0.725153,  -2.35746,   4.66469,   2.94707,  0.477737,-0.0994434,
		-0.34211,   -1.2327,   3.35005,   2.34698,   6.57927, -0.166319,
		-0.309615,    2.4839,  -11.5508,   1.45364,   6.97442,   3.73423,
		-0.86171,   3.28761,  -11.5832,   2.62277, -0.822246,   3.06822,
		0.426132,   1.79282,  -6.79833,   2.84104,  -3.77112,   1.22864,
		-0.323964,   1.53105,    1.5485,   4.11238,  -3.20102, -0.438832,
		-0.910222,  0.598327,   5.90394,   4.05559,   6.07286, -0.687289,
		0.66744, -0.385575,  -7.62308,   2.27964,   9.15765,   1.65352,
		-0.426234,   2.12853,  -8.21457,   3.45807,   3.65076,   1.15887,
		-0.695612,  0.684047,   2.34079,   4.52003, -0.990196, -0.528606,
		-0.622126,   -1.0511,   5.02841,   3.63247,   8.46174,  -0.47157,
		0.113446, -0.206379,  -9.89127,   1.91991,   7.61286,   2.13717,
		-0.961247,   1.57599,  -10.7246,   2.81963,    1.7414,   2.29305,
		-0.0478495,  -1.27688,  -3.99191,   3.45723,  -1.50898,  0.699623,
		-1.13209,   0.38367,   5.25187,   3.93721,    3.5866, -0.492314

	}; 
	
	Result r;
	
	r.periodic_idx = 2;
	r.RV_idx = 5;
	r.LV_idx = 0;
	// these two are not yet sure
	r.baseline_idx = 1;
	r.perfusion_idx = -2; // 3

	r.RV_peak = 10;
	r.LV_peak = 20;

	run( rdlength2, rdcomponents, init_real_data5,  r, false);
}

